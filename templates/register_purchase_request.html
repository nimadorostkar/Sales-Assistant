{% extends "layouts/base.html" %}
{% block title %} Dashboard {% endblock %}
<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}


{% block content %}
{% load bootstrap %}


<div class="row">
  <div class="col-md-12">
    <div class="card card-lavender">
      <div class="card-header">
        <h3 class="card-title" dir="rtl" align="center"> ثبت درخواست جدید </h3>
      </div>
    </div>
  </div>
</div>




    <form action="#" method="post" dir="rtl" align="right">
     {% csrf_token %}
     {{ purchase_req_form.as_p }}
     <hr>

     <div class="add-field" id="form">
          <label> محصول </label>
          <select name="product-0" id="0" class="form-control show-tick selectpicker">
            {% for Product in products %}
              <option value={{Product.id}}>{{Product.name}}</option>
            {% endfor %}
          </select>
          <label> تعداد </label>
          <input name="qty-0" type="number" class="form-control">
      </div>

      <input name="tot-counter" id="tot-counter" type="hidden" value="3487">

     <div class="card-footer">
       <button type="submit" class="btn btn-fill btn-primary"> ارسال </button>
     </div>
    </form>



    <button id="btn" type="button"> add extra product </button>








{% endblock content %}


<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
  <script>


    var products = [
      {% for Product in products %}
        { "name":"{{Product.name}}", "id":{{Product.id}} },
      {% endfor %}
     ];


    (function() {
      var counter = 0;
      var btn = document.getElementById('btn');
      var form = document.getElementById('form');
      var addInput = function() {
        counter++;

        var label = document.createElement("label");
        label.innerHTML = 'محصول';
        form.appendChild(label);
        var select = document.createElement("select");
        select.type = 'number';
        select.id = counter;
        select.name = 'product-' + counter;
        form.appendChild(select);

        var x = document.getElementById(counter);
        for (i = 0; i < products.length; i++) {
          var option = document.createElement("option");
          option.text = products[i].name;
          option.value = products[i].id;
          x.add(option);
        }

        var label = document.createElement("label");
        label.innerHTML = 'تعداد';
        form.appendChild(label);
        var input = document.createElement("input");
        input.type = 'number';
        input.name = 'qty-' + counter;
        form.appendChild(input);

        document.getElementById("tot-counter").value = counter ;

      };
      btn.addEventListener('click', function() {
        addInput();
      }.bind(this));
    })();







  </script>
{% endblock javascripts %}
